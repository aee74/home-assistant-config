- alias            : first_floor_landing_ceiling_on_day
  id               : 997e3172-eaae-4a75-98ed-bca25e751faa
  trigger:
    - platform     : state
      entity_id    : binary_sensor.first_floor_landing_motionsensor_occupancy
      to           : 'on'
    - platform     : state
      entity_id    : light.first_floor_landing_ceiling
      to           : 'on'            # Needed because its possible to start the light by hand without motion sensor detecting motion.
  condition:
    - condition    : state
      entity_id    : binary_sensor.night
      state        : 'off'
    - condition    : state
      entity_id    : timer.first_floor_landing_light_timeout
      state        : 'idle'
    - condition    : numeric_state
      entity_id    : sensor.first_floor_landing_motionsensor_illuminance
      below        : 35            # Lux
  action:
    - service      : light.turn_on
      data_template:
        entity_id     : light.first_floor_landing_ceiling
        kelvin        : "{{ state_attr('sensor.circadian_values', 'colortemp') | int }}"
        brightness_pct: "{{ state_attr('switch.circadian_lighting_landings', 'brightness') | int }}"
        transition    : 1
    - service      : timer.start    # this restarts the timer if it is already running
      entity_id    : timer.first_floor_landing_light_timeout
